(function(window,$,undefined){'use strict';var $mainNav=$(document.getElementById('main-nav')),$bottomBar=$(document.getElementById('bottom-bar'));$('.post-content').fitVids();$('.iso-height').equalcolumns();if($('.related-articles').length){var stickOffset=(wb.hasAdminBar())?$('.main-nav').height()+62:$('.main-nav').height()+30;$('.related-articles').hcSticky({top:stickOffset,offResolutions:[-1024]});}
function stickOrUnstick(){var stickOffset=(wb.hasAdminBar())?32:0;if(!wb.largerThan('tablet-wide')){if($mainNav.data('hcStickyInit')){$mainNav.hcSticky('destroy');}
$mainNav.attr('style','');}else{if(!$mainNav.data('hcStickyInit')){$mainNav.hcSticky({stickTo:document,top:stickOffset});}}}
stickOrUnstick();$(window).on('resize',function(){wb.debounce(stickOrUnstick(),300);});var mobileMenuButton=$(document.getElementById('toggle-mobile-menu')),mainHeaderEl=$(document.getElementById('main-header'));$(document).ready(function(){mobileMenuButton.attr('aria-expanded','false');});mobileMenuButton.on('click',function(e){e.preventDefault();mainHeaderEl.toggleClass('toggled');if(mainHeaderEl.hasClass('toggled')){mobileMenuButton.attr('aria-expanded','true');}else{mobileMenuButton.attr('aria-expanded','false');}});$('.menu-item-has-children').on('click','> a',function(e){e.preventDefault();$(this).parent('li').toggleClass('active');$(this).next('.sub-menu').slideToggle();}).on('focus','a',function(e){$(this).parentsUntil('menu-item-has-children').addClass('focused');}).on('blur','a',function(e){$(this).parentsUntil('menu-item-has-children').removeClass('focused');});$('.jetpack-slideshow').each(function(){var $container=$(this);var interval=setInterval(function(){if(true===$container.data('processed')){clearInterval(interval);var attachment_data=$container.nextAll('.jetpack-slideshow-attachments:first').data('gallery');console.log(attachment_data);$('.slideshow-slide',$container).each(function(i,el){var $div=$('<div>',{'class':'slideshow-slide-link'});var src=$(this).find('img').attr('src');src=src.replace(/-\d+x\d+(\.\S+)$/,function(match,contents,offset,s){return contents;});console.log(src);var $link=$('<a>',{text:'Download in Hi Res','href':attachment_data[src].url,'class':'download-link'});$div.append($link);$(this).prepend($div);});}},300);var $thumb_container=$('<div>',{'class':'slideshow-slide-thumb-container',});var thumb_slideshow_controls='<div class="slideshow-controls">'+'<a class="prev" href="#"></a>'+'<a href="#" class="paused"></a>'+'<a href="#" class="next"></a>'+'</div>';var images=$container.data('gallery');$.each($container.data('gallery'),function(index,element){var $div=$('<div>',{'class':'slideshow-slide-thumb',});if(index>=3){$div.css('display','none');}
$div.css('background-image','url('+this.src+')');$thumb_container.append($div);});$thumb_container.append(thumb_slideshow_controls);$container.after($thumb_container);$('.slideshow-controls a.prev').css('visibility','hidden');if(images.length<=3){$('.slideshow-controls a.next').css('visibility','hidden');}
var first_visible=1;var last_visible=3;$thumb_container.on('click','.slideshow-controls a',function(e){var $clicked_el=$(this);if($clicked_el.hasClass('next')&&last_visible<images.length){$('.slideshow-slide-thumb:nth-child( '+first_visible+')',$thumb_container).hide();first_visible+=1;last_visible+=1;$('.slideshow-slide-thumb:nth-child( '+last_visible+')',$thumb_container).show();$clicked_el.siblings('.prev').css('visibility','visible');if(last_visible===images.length){$clicked_el.css('visibility','hidden');}}else if($clicked_el.hasClass('prev')&&first_visible>1){first_visible-=1;$('.slideshow-slide-thumb:nth-child( '+first_visible+')',$thumb_container).show();$('.slideshow-slide-thumb:nth-child( '+last_visible+')',$thumb_container).hide();last_visible-=1;$clicked_el.siblings('.next').css('visibility','visible');if(first_visible===1){$clicked_el.css('visibility','hidden');}}
e.preventDefault();e.stopImmediatePropagation();});$thumb_container.on('click','.slideshow-slide-thumb',function(e){$container.cycle($(this).index());});});function shareUsingSkypeRawLink(){var guid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=crypto.getRandomValues(new Uint8Array(1))[0]%16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});window.open('https://web.skype.com/share?url='+$(location).attr('href')+'&lang=en-US&flow_id='+guid,'_blank','toolbar=no, scrollbars=yes, resizable=yes, width=305, height=665');return false;}
$('.addthis_button_skype').on('click',function(e){e.preventDefault();shareUsingSkypeRawLink();});function searchToggle(){var searchForm=$mainNav.find('.search-form');searchForm.on('click','.icon-search',function(){searchForm.toggleClass('is-active');});}
searchToggle();var currentMenuItem=$mainNav.find('.network-menu .ms-current-blog'),siteNavigation=$bottomBar.find('.site-menu-container').clone(),stickyWrapper=$bottomBar.find('.wrapper-sticky');if(0<currentMenuItem.length&&1===siteNavigation.length){currentMenuItem=$(currentMenuItem[0]);siteNavigation.addClass('site-menu-clone');currentMenuItem.append(siteNavigation);}
if(0===siteNavigation.length){stickyWrapper.addClass('no-site-nav');}})(this,jQuery);